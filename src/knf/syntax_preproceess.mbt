/// Preprocesses the syntax tree, extracting the contents of functions `main` and `init` to top-level.
pub fn KnfEnv::syntax_preprocess(
  self : KnfEnv,
  ast : @types.Syntax
) -> @types.Syntax {
  println("æç¤ºï¼šå¼€å§‹æå–mianå’Œinitå‡½æ•°åˆ°é¡¶å±‚")
  let init_array=[]
  let main_array=[]
  let other_ast_array=[]
  let all_ast_array=[]

  match ast{
    Seq(ast_array) => {
      for one_ast in ast_array{
          match one_ast{
            LetRec({name:(fun_name,fun_type), args:params, body:body}, Unit)=>{
              if fun_name == "init"{
                init_array.push(body)
                all_ast_array.push(body)
              }else if fun_name == "main"{  // initå‡½æ•°åœ¨åŒ…åˆå§‹åŒ–çš„æ—¶å€™æ‰§è¡Œï¼Œmainå‡½æ•°åœ¨initå‡½æ•°ä¹‹åæ‰§è¡Œï¼Œå…¶ä»–é¡¶å±‚è¯­å¥ä»€ä¹ˆæ—¶å€™æ‰§è¡Œå‘¢ï¼Ÿ(ä¸€æµ‹ä¾¿çŸ¥)
                main_array.push(body)
                all_ast_array.push(body)
              }else{
                other_ast_array.push(one_ast)
                all_ast_array.push(one_ast)
              }
            }
            _ => {
                other_ast_array.push(one_ast)
                all_ast_array.push(one_ast)
            }
          }

      }
    }
    _ => @util.die("ç«Ÿç„¶æ²¡æœ‰SeqğŸ˜€")
  }
  // println("å°†initå’Œmainå‡½æ•°å†…å®¹æå–åˆ°é¡¶å±‚ï¼š\{@types.Syntax::Seq(init_array + main_array + other_ast_array)}")
  // Seq(init_array + main_array + other_ast_array)
  println("å°†initå’Œmainå‡½æ•°å†…å®¹æå–åˆ°é¡¶å±‚ï¼š\{@types.Syntax::Seq(all_ast_array)}")
  Seq(all_ast_array)
}
